# -*- coding: utf-8 -*-
from urllib import quote
from urllib import urlencode
from urlparse import urljoin


def create_url(base, path=None, *query):
    url = base

    # Add the path to the url if it's not None.
    if path is not None:
        url = urljoin(url, quote(path))

    # Remove key/value pairs with None values.
    query = filter(lambda pair: pair[1] is not None, query)

    # Add the query string to the url
    url = urljoin(url, '?{0}'.format(urlencode(list(query))))
    return url